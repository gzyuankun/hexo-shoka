<!-- build time:Tue Jun 06 2023 19:27:33 GMT+0800 (中国标准时间) --><!DOCTYPE html><html lang="zh-CN"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=2"><meta name="theme-color" content="#FFF"><link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon.png"><link rel="icon" type="image/ico" sizes="32x32" href="/images/favicon.ico"><meta http-equiv="Cache-Control" content="no-transform"><meta http-equiv="Cache-Control" content="no-siteapp"><link rel="alternate" type="application/rss+xml" title="Hide your thoughts" href="http://blog.itshare.work/rss.xml"><link rel="alternate" type="application/atom+xml" title="Hide your thoughts" href="http://blog.itshare.work/atom.xml"><link rel="alternate" type="application/json" title="Hide your thoughts" href="http://blog.itshare.work/feed.json"><link rel="stylesheet" href="//fonts.googleapis.com/css?family=Mulish:300,300italic,400,400italic,700,700italic%7CFredericka%20the%20Great:300,300italic,400,400italic,700,700italic%7CNoto%20Serif%20JP:300,300italic,400,400italic,700,700italic%7CNoto%20Serif%20SC:300,300italic,400,400italic,700,700italic%7CInconsolata:300,300italic,400,400italic,700,700italic&display=swap&subset=latin,latin-ext"><link rel="stylesheet" href="/css/app.css?v=0.2.5"><meta name="keywords" content="Kubernetes"><link rel="canonical" href="http://blog.itshare.work/Kubernetes/%E6%90%AD%E5%BB%BAKubernetes%E9%9B%86%E7%BE%A4/"><title>搭建Kubernetes集群 - Kubernetes | Cookie = Hide your thoughts</title><meta name="generator" content="Hexo 6.3.0"></head><body itemscope itemtype="http://schema.org/WebPage"><div id="loading"><div class="cat"><div class="body"></div><div class="head"><div class="face"></div></div><div class="foot"><div class="tummy-end"></div><div class="bottom"></div><div class="legs left"></div><div class="legs right"></div></div><div class="paw"><div class="hands left"></div><div class="hands right"></div></div></div></div><div id="container"><header id="header" itemscope itemtype="http://schema.org/WPHeader"><div class="inner"><div id="brand"><div class="pjax"><h1 itemprop="name headline">搭建Kubernetes集群</h1><div class="meta"><span class="item" title="创建时间：2023-03-21 00:14:18"><span class="icon"><i class="ic i-calendar"></i> </span><span class="text">发表于</span> <time itemprop="dateCreated datePublished" datetime="2023-03-21T00:14:18+08:00">2023-03-21</time> </span><span class="item" title="本文字数"><span class="icon"><i class="ic i-pen"></i> </span><span class="text">本文字数</span> <span>13k</span> <span class="text">字</span> </span><span class="item" title="阅读时长"><span class="icon"><i class="ic i-clock"></i> </span><span class="text">阅读时长</span> <span>12 分钟</span></span></div></div></div><nav id="nav"><div class="inner"><div class="toggle"><div class="lines" aria-label="切换导航栏"><span class="line"></span> <span class="line"></span> <span class="line"></span></div></div><ul class="menu"><li class="item title"><a href="/" rel="start">Cookie</a></li></ul><ul class="right"><li class="item theme"><i class="ic i-sun"></i></li><li class="item search"><i class="ic i-search"></i></li></ul></div></nav></div><div id="imgs" class="pjax"><ul><li class="item" data-background-image="http://oss.itshare.work/itshare-work-images/4.jpg"></li><li class="item" data-background-image="http://oss.itshare.work/itshare-work-images/16.jpg"></li><li class="item" data-background-image="http://oss.itshare.work/itshare-work-images/22.jpg"></li><li class="item" data-background-image="http://oss.itshare.work/itshare-work-images/19.jpg"></li><li class="item" data-background-image="http://oss.itshare.work/itshare-work-images/21.jpg"></li><li class="item" data-background-image="http://oss.itshare.work/itshare-work-images/25.jpg"></li></ul></div></header><div id="waves"><svg class="waves" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 24 150 28" preserveAspectRatio="none" shape-rendering="auto"><defs><path id="gentle-wave" d="M-160 44c30 0 58-18 88-18s 58 18 88 18 58-18 88-18 58 18 88 18 v44h-352z"/></defs><g class="parallax"><use xlink:href="#gentle-wave" x="48" y="0"/><use xlink:href="#gentle-wave" x="48" y="3"/><use xlink:href="#gentle-wave" x="48" y="5"/><use xlink:href="#gentle-wave" x="48" y="7"/></g></svg></div><main><div class="inner"><div id="main" class="pjax"><div class="article wrap"><div class="breadcrumb" itemscope itemtype="https://schema.org/BreadcrumbList"><i class="ic i-home"></i> <span><a href="/">首页</a></span><i class="ic i-angle-right"></i> <span class="current" itemprop="itemListElement" itemscope itemtype="https://schema.org/ListItem"><a href="/categories/Kubernetes/" itemprop="item" rel="index" title="分类于 Kubernetes"><span itemprop="name">Kubernetes</span></a><meta itemprop="position" content="1"></span></div><article itemscope itemtype="http://schema.org/Article" class="post block" lang="zh-CN"><link itemprop="mainEntityOfPage" href="http://blog.itshare.work/Kubernetes/%E6%90%AD%E5%BB%BAKubernetes%E9%9B%86%E7%BE%A4/"><span hidden itemprop="author" itemscope itemtype="http://schema.org/Person"><meta itemprop="image" content="/images/avatar.jpg"><meta itemprop="name" content="yuan kun"><meta itemprop="description" content=", 解决各种服务器、网络、应用等技术问题，致力于保障系统稳定、高效运行"></span><span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization"><meta itemprop="name" content="Hide your thoughts"></span><div class="body md" itemprop="articleBody"><h1 id="搭建Kubernetes集群"><a href="#搭建Kubernetes集群" class="headerlink" title="搭建Kubernetes集群"></a>搭建Kubernetes集群</h1><h2 id="部署前提"><a href="#部署前提" class="headerlink" title="部署前提"></a>部署前提</h2><ul><li>使用kubeadm部署Kubernetes集群的前提条件</li><li>支持Kubernetes运行的Linux主机，例如Debian、RedHat及其变体等</li><li>每主机2GB以上的内存，以及2颗以上的CPU</li><li>各主机间能够通过网络无障碍通信</li><li>独占的hostname、MAC地址以及product_uuid，主机名能够正常解析</li><li>放行由Kubernetes使用到的各端口，或直接禁用iptables</li><li>禁用各主机的上的Swap设备</li><li>各主机时间同步</li></ul><h2 id="部署环境"><a href="#部署环境" class="headerlink" title="部署环境"></a>部署环境</h2><ul><li>OS: Ubuntu 20.04.2 LTS</li><li>Docker：20.10.10，CGroup Driver: systemd</li><li>Kubernetes：v1.26.3, CRI: containerd, CNI: Flannel</li><li>主机</li></ul><table><thead><tr><th>主机IP</th><th>主机名称</th><th>角色</th></tr></thead><tbody><tr><td>192.168.32.200</td><td>k8s-master01.org</td><td>master</td></tr><tr><td>192.168.32.203</td><td>k8s-node01.org</td><td>node01</td></tr><tr><td>192.168.32.204</td><td>k8s-node02.org</td><td>node02</td></tr><tr><td>192.168.32.205</td><td>k8s-node03.org</td><td>node03</td></tr></tbody></table><h2 id="修改主机名称"><a href="#修改主机名称" class="headerlink" title="修改主机名称"></a>修改主机名称</h2><pre><code class="sh"># 修改192.168.32.200的主机名称为k8s-master01.org
# 修改192.168.32.203的主机名称为k8s-node01.org
# 修改192.168.32.204的主机名称为k8s-node02.org
# 修改192.168.32.205的主机名称为k8s-node03.org
</code></pre><h2 id="主机时间同步"><a href="#主机时间同步" class="headerlink" title="主机时间同步"></a>主机时间同步</h2><p>在所有主机上安装 chrony</p><pre><code class="sh">## 所有主机上执行
root@k8s-master01:~# apt install -y chrony
</code></pre><p>建议用户配置使用本地的的时间服务器，在节点数量众多时尤其如此。存在可用的本地时间服务器时，修改节点的&#x2F;etc&#x2F;chrony&#x2F;chrony.conf配置文件，并将时间服务器指向相应的主机即可，配置格式如下：</p><pre><code class="sh">server CHRONY-SERVER-NAME-OR-IP iburst
</code></pre><h2 id="主机名称解析"><a href="#主机名称解析" class="headerlink" title="主机名称解析"></a>主机名称解析</h2><p>出于简化配置步骤的目的，本测试环境使用hosts文件进行各节点名称解析，文件内容如下所示。其中，我们使用kubeapi主机名作为API Server在高可用环境中的专用接入名称，也为控制平面的高可用配置留下便于配置的余地。</p><pre><code class="sh"># 编辑/etc/hosts文件加入如下内容
root@k8s-master01:~# vim /etc/hosts
192.168.32.200 k8s-master01.org
192.168.32.203 k8s-node01.org
192.168.32.204 k8s-node02.org
192.168.32.205 k8s-node03.org
</code></pre><h2 id="禁用Swap设备"><a href="#禁用Swap设备" class="headerlink" title="禁用Swap设备"></a>禁用Swap设备</h2><p>部署集群时，kubeadm默认会预先检查当前主机是否禁用了Swap设备，并在未禁用时强制终止部署过程。因此，在主机内存资源充裕的条件下，需要禁用所有的Swap设备，否则，就需要在后文的kubeadm init及kubeadm join命令执行时额外使用相关的选项忽略检查错误。</p><p>关闭Swap设备，需要分两步完成。首先是关闭当前已启用的所有Swap设备：</p><pre><code class="sh"># 临时关闭，所有机器执行
root@k8s-master01:~# swapoff -a
</code></pre><p>而后编辑&#x2F;etc&#x2F;fstab配置文件，注释用于挂载Swap设备的所有行</p><pre><code class="sh"># 所有机器执行
root@k8s-master01:~#vim /etc/fstab
# 注释如下一行
#/swap.img      none    swap    sw      0       0
</code></pre><h2 id="禁用默认的防火墙服务"><a href="#禁用默认的防火墙服务" class="headerlink" title="禁用默认的防火墙服务"></a>禁用默认的防火墙服务</h2><p>Ubuntu和Debian等Linux发行版默认使用ufw（Uncomplicated FireWall）作为前端来简化 iptables的使用，处于启用状态时，它默认会生成一些规则以加强系统安全。出于降低配置复杂度之目的，本文选择直接将其禁用。</p><pre><code class="sh">root@k8s-master01:~# ufw disable
Firewall stopped and disabled on system startup
root@k8s-master01:~# ufw status
Status: inactive
root@k8s-master01:~# 
</code></pre><h2 id="安装程序包"><a href="#安装程序包" class="headerlink" title="安装程序包"></a>安装程序包</h2><p>提示：以下操作需要在本示例中的所有四台主机上分别进行</p><h3 id="安装并启动docker"><a href="#安装并启动docker" class="headerlink" title="安装并启动docker"></a>安装并启动docker</h3><p>首先，生成docker-ce相关程序包的仓库，这里以阿里云的镜像服务器为例进行说明<br><span class="exturl" data-url="aHR0cHM6Ly9kZXZlbG9wZXIuYWxpeXVuLmNvbS9taXJyb3IvZG9ja2VyLWNlP3NwbT1hMmM2aC4xMzY1MTEwMi4wLjAuM2UyMjFiMTFld0FsMnI=">docker-ce镜像_docker-ce下载地址_docker-ce安装教程-阿里巴巴开源镜像站 (aliyun.com)</span></p><pre><code class="sh"># step 1: 安装必要的一些系统工具
sudo apt-get update
sudo apt-get -y install apt-transport-https ca-certificates curl software-properties-common
# step 2: 安装GPG证书
curl -fsSL https://mirrors.aliyun.com/docker-ce/linux/ubuntu/gpg | sudo apt-key add -
# Step 3: 写入软件源信息
sudo add-apt-repository &quot;deb [arch=amd64] https://mirrors.aliyun.com/docker-ce/linux/ubuntu $(lsb_release -cs) stable&quot;
# Step 4: 更新并安装Docker-CE
sudo apt-get -y update
sudo apt-get -y install docker-ce

# 安装指定版本的Docker-CE:
# Step 1: 查找Docker-CE的版本:
# apt-cache madison docker-ce
#   docker-ce | 17.03.1~ce-0~ubuntu-xenial | https://mirrors.aliyun.com/docker-ce/linux/ubuntu xenial/stable amd64 Packages
#   docker-ce | 17.03.0~ce-0~ubuntu-xenial | https://mirrors.aliyun.com/docker-ce/linux/ubuntu xenial/stable amd64 Packages
# Step 2: 安装指定版本的Docker-CE: (VERSION例如上面的17.03.1~ce-0~ubuntu-xenial)
# sudo apt-get -y install docker-ce=[VERSION]
</code></pre><p>本文以为20.10.10版本为例</p><pre><code class="sh">root@k8s-node3:~# apt install docker-ce=5:20.10.10~3-0~ubuntu-focal docker-ce-cli=5:20.10.10~3-0~ubuntu-focal
</code></pre><p>kubelet需要让docker容器引擎使用systemd作为CGroup的驱动，其默认值为cgroupfs，因而，我们还需要编辑docker的配置文件&#x2F;etc&#x2F;docker&#x2F;daemon.json，添加如下内容，其中的registry-mirrors用于指明使用的镜像加速服务。</p><pre><code class="sh">vim /etc/docker/daemon.json
&#123;
&quot;registry-mirrors&quot;: [
  &quot;https://ung2thfc.mirror.aliyuncs.com&quot;,
  &quot;https://mirror.ccs.tencentyun.com&quot;,
  &quot;https://registry.docker-cn.com&quot;,
  &quot;http://hub-mirror.c.163.com&quot;,
  &quot;https://docker.mirrors.ustc.edu.cn&quot;],
&quot;exec-opts&quot;: [&quot;native.cgroupdriver=systemd&quot;]
&#125;

systemctl daemon-reload &amp;&amp; systemctl restart docker
</code></pre><h2 id="安装cri-dockerd"><a href="#安装cri-dockerd" class="headerlink" title="安装cri-dockerd"></a>安装cri-dockerd</h2><p>Kubernetes自v1.24移除了对docker-shim的支持，而Docker Engine默认又不支持CRI规范，因而二者将无法直接完成整合。为此，Mirantis和Docker联合创建了cri-dockerd项目，用于为Docker Engine提供一个能够支持到CRI规范的垫片，从而能够让Kubernetes基于CRI控制Docker 。</p><p><span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL01pcmFudGlzL2NyaS1kb2NrZXJk">项目地址</span></p><p>cri-dockerd项目提供了预制的二进制格式的程序包，用户按需下载相应的系统和对应平台的版本即可完成安装，这里以Ubuntu 2004 64bits系统环境，以及cri-dockerd目前最新的程序版本v0.3.0为例。</p><pre><code class="sh">wget https://github.com/Mirantis/cri-dockerd/releases/download/v0.3.0/cri-dockerd_0.3.0.3-0.ubuntu-focal_amd64.deb

dpkg -i cri-dockerd_0.3.0.3-0.ubuntu-focal_amd64.deb
</code></pre><p>完成安装后，相应的服务cri-dockerd.service便会自动启动。我们也可以使用如下命令进行验证，若服务处于Running状态即可进行后续步骤 。</p><pre><code class="sh">root@k8s-master01:~# systemctl status cri-docker.service
● cri-docker.service - CRI Interface for Docker Application Container Engine
     Loaded: loaded (/lib/systemd/system/cri-docker.service; enabled; vendor preset: enabled)
     Active: active (running) since Tue 2023-03-21 10:59:57 CST; 1min 20s ago
TriggeredBy: ● cri-docker.socket
       Docs: https://docs.mirantis.com
   Main PID: 17591 (cri-dockerd)
      Tasks: 7
     Memory: 11.9M
     CGroup: /system.slice/cri-docker.service
             └─17591 /usr/bin/cri-dockerd --container-runtime-endpoint fd://

Mar 21 10:59:57 k8s-master01.org cri-dockerd[17591]: time=&quot;2023-03-21T10:59:57+08:00&quot; level=info msg=&quot;Start docker client with request timeout 0s&quot;
Mar 21 10:59:57 k8s-master01.org cri-dockerd[17591]: time=&quot;2023-03-21T10:59:57+08:00&quot; level=info msg=&quot;Hairpin mode is set to none&quot;
Mar 21 10:59:57 k8s-master01.org cri-dockerd[17591]: time=&quot;2023-03-21T10:59:57+08:00&quot; level=info msg=&quot;Loaded network plugin cni&quot;
Mar 21 10:59:57 k8s-master01.org cri-dockerd[17591]: time=&quot;2023-03-21T10:59:57+08:00&quot; level=info msg=&quot;Docker cri networking managed by network plugin cni&quot;
Mar 21 10:59:57 k8s-master01.org systemd[1]: Started CRI Interface for Docker Application Container Engine.
Mar 21 10:59:58 k8s-master01.org cri-dockerd[17591]: time=&quot;2023-03-21T10:59:57+08:00&quot; level=info msg=&quot;Docker Info: &amp;&#123;ID:WQBA:P7R2:H6ZI:KWU3:FVFW:MHLC:QTT7:CJCX&gt;
Mar 21 10:59:58 k8s-master01.org cri-dockerd[17591]: time=&quot;2023-03-21T10:59:57+08:00&quot; level=info msg=&quot;Setting cgroupDriver cgroupfs&quot;
Mar 21 10:59:58 k8s-master01.org cri-dockerd[17591]: time=&quot;2023-03-21T10:59:57+08:00&quot; level=info msg=&quot;Docker cri received runtime config &amp;RuntimeConfig&#123;Network&gt;
Mar 21 10:59:58 k8s-master01.org cri-dockerd[17591]: time=&quot;2023-03-21T10:59:57+08:00&quot; level=info msg=&quot;Starting the GRPC backend for the Docker CRI interface.&quot;
Mar 21 10:59:58 k8s-master01.org cri-dockerd[17591]: time=&quot;2023-03-21T10:59:57+08:00&quot; level=info msg=&quot;Start cri-dockerd grpc backend&quot;
lines 1-21/21 (END)
</code></pre><h2 id="安装kubelet、kubeadm和kubectl"><a href="#安装kubelet、kubeadm和kubectl" class="headerlink" title="安装kubelet、kubeadm和kubectl"></a>安装kubelet、kubeadm和kubectl</h2><p>首先，在各主机上生成kubelet和kubeadm等相关程序包的仓库，这里以阿里云的镜像服务为例</p><pre><code class="sh">apt-get update &amp;&amp; apt-get install -y apt-transport-https
curl https://mirrors.aliyun.com/kubernetes/apt/doc/apt-key.gpg | apt-key add - 
cat &lt;&lt;EOF &gt;/etc/apt/sources.list.d/kubernetes.list
deb https://mirrors.aliyun.com/kubernetes/apt/ kubernetes-xenial main
EOF
apt-get update
apt-get install -y kubelet kubeadm kubectl
</code></pre><p>安装完成后，要确保kubeadm等程序文件的版本，这将也是后面初始化Kubernetes集群时需要明确指定的版本号</p><h3 id="整合kubelet和cri-dockerd"><a href="#整合kubelet和cri-dockerd" class="headerlink" title="整合kubelet和cri-dockerd"></a>整合kubelet和cri-dockerd</h3><p>仅支持CRI规范的kubelet需要经由遵循该规范的cri-dockerd完成与docker-ce的整合。</p><h3 id="配置cri-dockerd"><a href="#配置cri-dockerd" class="headerlink" title="配置cri-dockerd"></a>配置cri-dockerd</h3><p>配置cri-dockerd，确保其能够正确加载到CNI插件。编辑&#x2F;usr&#x2F;lib&#x2F;systemd&#x2F;system&#x2F;cri-docker.service文件，确保其[Service]配置段中的ExecStart的值类似如下内容</p><pre><code class="sh">ExecStart=/usr/bin/cri-dockerd --container-runtime-endpoint fd:// --network-plugin=cni --pod-infra-container-image=registry.aliyuncs.com/google_containers/pause:3.7 --cni-bin-dir=/opt/cni/bin --cni-cache-dir=/var/lib/cni/cache --cni-conf-dir=/etc/cni/net.d
</code></pre><p>需要添加的各配置参数（各参数的值要与系统部署的CNI插件的实际路径相对应）：</p><ul><li>–network-plugin：指定网络插件规范的类型，这里要使用CNI；</li><li>–cni-bin-dir：指定CNI插件二进制程序文件的搜索目录；</li><li>–cni-cache-dir：CNI插件使用的缓存目录；</li><li>–cni-conf-dir：CNI插件加载配置文件的目录；</li></ul><p>配置完成后，重载并重启cri-docker.service服务。</p><pre><code class="sh">root@k8s-master01:~# systemctl daemon-reload;systemctl restart cri-docker
</code></pre><h2 id="配置kubelet"><a href="#配置kubelet" class="headerlink" title="配置kubelet"></a>配置kubelet</h2><p>配置kubelet，为其指定cri-dockerd在本地打开的Unix Sock文件的路径，该路径一般默认为“&#x2F;run&#x2F;cri-dockerd.sock“。编辑文件&#x2F;etc&#x2F;sysconfig&#x2F;kubelet，为其添加 如下指定参数。</p><blockquote><p>提示：若&#x2F;etc&#x2F;sysconfig目录不存在，则需要先创建该目录。</p></blockquote><pre><code class="sh">KUBELET_KUBEADM_ARGS=&quot;--container-runtime=remote --container-runtime-endpoint=/run/cri-dockerd.sock&quot;
</code></pre><p>需要说明的是，该配置也可不进行，而是直接在后面的各kubeadm命令上使用“–cri-socket unix:&#x2F;&#x2F;&#x2F;run&#x2F;cri-dockerd.sock”选项。</p><h3 id="初始化第一个主节点"><a href="#初始化第一个主节点" class="headerlink" title="初始化第一个主节点"></a>初始化第一个主节点</h3><p>该步骤开始尝试构建Kubernetes集群的master节点，配置完成后，各worker节点直接加入到集群中的即可。需要特别说明的是，由kubeadm部署的Kubernetes集群上，集群核心组件kube-apiserver、kube-controller-manager、kube-scheduler和etcd等均会以静态Pod的形式运行，它们所依赖的镜像文件默认来自于registry.k8s.io这一Registry服务之上。但我们无法直接访问该服务，常用的解决办法有如下两种</p><ul><li>使用能够到达该服务的代理服务；</li><li>使用国内的镜像服务器上的服务，例如registry.aliyuncs.com&#x2F;google_containers等。</li></ul><h3 id="初始化master节点（在k8s-master01上完成如下操作）"><a href="#初始化master节点（在k8s-master01上完成如下操作）" class="headerlink" title="初始化master节点（在k8s-master01上完成如下操作）"></a>初始化master节点（在k8s-master01上完成如下操作）</h3><p>运行如下命令完成k8s-master01节点的初始化：</p><pre><code class="sh">kubeadm init --image-repository registry.aliyuncs.com/google_containers --kubernetes-version=v1.26.3 --pod-network-cidr=10.244.0.0/16 --service-cidr=10.96.0.0/12 --token-ttl=0 --cri-socket unix:///run/cri-dockerd.sock
</code></pre><p>命令中的各选项简单说明如下：</p><ul><li>–image-repository：指定要使用的镜像仓库，默认为registry.k8s.io；</li><li>–kubernetes-version：kubernetes程序组件的版本号，它必须要与安装的kubelet程序包的版本号相同；</li><li>–control-plane-endpoint：控制平面的固定访问端点，可以是IP地址或DNS名称，会被用于集群管理员及集群组件的kubeconfig配置文件的API Server的访问地址；单控制平面部署时可以不使用该选项；</li><li>–pod-network-cidr：Pod网络的地址范围，其值为CIDR格式的网络地址，通常，Flannel网络插件的默认为10.244.0.0&#x2F;16，Project Calico插件的默认值为192.168.0.0&#x2F;16；</li><li>–service-cidr：Service的网络地址范围，其值为CIDR格式的网络地址，默认为10.96.0.0&#x2F;12；通常，仅Flannel一类的网络插件需要手动指定该地址；</li><li>–apiserver-advertise-address：apiserver通告给其他组件的IP地址，一般应该为Master节点的用于集群内部通信的IP地址，0.0.0.0表示节点上所有可用地址；</li><li>–token-ttl：共享令牌（token）的过期时长，默认为24小时，0表示永不过期；为防止不安全存储等原因导致的令牌泄露危及集群安全，建议为其设定过期时长。未设定该选项时，在token过期后，若期望再向集群中加入其它节点，可以使用如下命令重新创建token，并生成节点加入命令。</li></ul><h4 id="初始化完成后的操作步骤"><a href="#初始化完成后的操作步骤" class="headerlink" title="初始化完成后的操作步骤"></a>初始化完成后的操作步骤</h4><p>对于Kubernetes系统的新用户来说，无论使用上述哪种方法，命令运行结束后，请记录最后的kubeadm join命令输出的最后提示的操作步骤。下面的内容是需要用户记录的一个命令输出示例，它提示了后续需要的操作步骤。</p><pre><code class="sh"># 下面是成功完成第一个控制平面节点初始化的提示信息及后续需要完成的步骤
Your Kubernetes control-plane has initialized successfully!

# 为了完成初始化操作，管理员需要额外手动完成几个必要的步骤
To start using your cluster, you need to run the following as a regular user:

# 第1个步骤提示， Kubernetes集群管理员认证到Kubernetes集群时使用的kubeconfig配置文件
mkdir -p $HOME/.kube
sudo cp -i /etc/kubernetes/admin.conf $HOME/.kube/config
sudo chown $(id -u):$(id -g) $HOME/.kube/config

# 我们也可以不做上述设定，而使用环境变量KUBECONFIG为kubectl等指定默认使用的kubeconfig；
Alternatively, if you are the root user, you can run:

export KUBECONFIG=/etc/kubernetes/admin.conf

# 第2个步骤提示，为Kubernetes集群部署一个网络插件，具体选用的插件则取决于管理员；
You should now deploy a pod network to the cluster.
Run &quot;kubectl apply -f [podnetwork].yaml&quot; with one of the options listed at:
https://kubernetes.io/docs/concepts/cluster-administration/addons/

# 第3个步骤提示，向集群添加额外的控制平面节点，但本文会略过该步骤，并将在其它文章介绍其实现方式。
You can now join any number of the control-plane node running the following command on each as root:

# 第4个步骤提示，向集群添加工作节点
Then you can join any number of worker nodes by running the following on each as root:

# 在部署好kubeadm等程序包的各工作节点上以root用户运行类似如下命令；
# 提示：与cri-dockerd结合使用docker-ce作为container runtime时，通常需要为下面的命令
#     额外附加“--cri-socket unix:///run/cri-dockerd.sock”选项；
kubeadm join 192.168.32.200:6443 --token ivu3t7.pogk70dd5pualoz2 \
--discovery-token-ca-cert-hash
sha256:3edb3c8e3e6c944afe65b2616d46b49305c1420e6967c1fab966ddf8f149502d
</code></pre><h3 id="设定kubectl"><a href="#设定kubectl" class="headerlink" title="设定kubectl"></a>设定kubectl</h3><p>kubectl是kube-apiserver的命令行客户端程序，实现了除系统部署之外的几乎全部的管理操作，是kubernetes管理员使用最多的命令之一。kubectl需经由API server认证及授权后方能执行相应的管理操作，kubeadm部署的集群为其生成了一个具有管理员权限的认证配置文件&#x2F;etc&#x2F;kubernetes&#x2F;admin.conf，它可由kubectl通过默认的“$HOME&#x2F;.kube&#x2F;config”的路径进行加载。当然，用户也可在kubectl命令上使用–kubeconfig选项指定一个别的位置。</p><p>下面复制认证为Kubernetes系统管理员的配置文件至目标用户（例如当前用户root）的家目录下：</p><p>~# mkdir ~&#x2F;.kube</p><p>~# cp &#x2F;etc&#x2F;kubernetes&#x2F;admin.conf ~&#x2F;.kube&#x2F;config</p><h3 id="部署网络插件"><a href="#部署网络插件" class="headerlink" title="部署网络插件"></a>部署网络插件</h3><p>Kubernetes系统上Pod网络的实现依赖于第三方插件进行，这类插件有近数十种之多，较为著名的有flannel、calico、canal和kube-router等，简单易用的实现是为CoreOS提供的flannel项目。下面的命令用于在线部署flannel至Kubernetes系统之上：</p><p>首先，下载适配系统及硬件平台环境的flanneld至每个节点，并放置于&#x2F;opt&#x2F;bin&#x2F;目录下。我们这里选用flanneld-amd64，目前最新的版本为v0.21.3，因而，我们需要在集群的每个节点上执行如下命令：</p><pre><code class="sh">~# mkdir /opt/cni/bin/

~# curl -L https://github.com/flannel-io/flannel/releases/download/v0.20.2/flanneld-amd64  -o /opt/cni/bin/flanneld

~# chmod +x /opt/cni/bin/flanneld

提示：下载flanneld的地址为 https://github.com/flannel-io/flannel/releases
</code></pre><p>随后，在初始化的第一个master节点k8s-master01上运行如下命令，向Kubernetes部署kube-flannel</p><pre><code class="sh">kubectl apply -f https://raw.githubusercontent.com/flannel-io/flannel/v0.21.3/Documentation/kube-flannel.yml
</code></pre><p>而后使用如下命令确认其输出结果中Pod的状态为“Running”，类似如下命令及其输入的结果所示：</p><pre><code class="sh">root@k8s-master01:~#  kubectl get pods -n kube-flannel
NAME                    READY   STATUS    RESTARTS   AGE
kube-flannel-ds-jgkxd   1/1     Running   0          2m59s
root@k8s-master01:~# 
</code></pre><h3 id="验证master节点已经就绪"><a href="#验证master节点已经就绪" class="headerlink" title="验证master节点已经就绪"></a>验证master节点已经就绪</h3><p>kubectl get nodes</p><p>上述命令应该会得到类似如下输出，这表示k8s-master01节点已经就绪</p><pre><code class="sh">root@k8s-master01:~# kubectl get nodes
NAME               STATUS   ROLES           AGE   VERSION
k8s-master01.org   Ready    control-plane   62m   v1.26.3
root@k8s-master01:~# 
</code></pre><h3 id="添加节点到集群中"><a href="#添加节点到集群中" class="headerlink" title="添加节点到集群中"></a>添加节点到集群中</h3><p>下面的两个步骤，需要分别在k8s-node01、k8s-node02和k8s-node03上各自完成。</p><p>1、若未禁用Swap设备，编辑kubelet的配置文件&#x2F;etc&#x2F;default&#x2F;kubelet，设置其忽略Swap启用的状态错误，内容如下：KUBELET_EXTRA_ARGS&#x3D;”–fail-swap-on&#x3D;false”</p><p>2、将节点加入第二步中创建的master的集群中，要使用主节点初始化过程中记录的kubeadm join命令；</p><pre><code class="sh">root@k8s-node01:/opt/cni/bin# kubeadm join 192.168.32.200:6443 --token ivu3t7.pogk70dd5pualoz2 --discovery-token-ca-cert-hash sha256:3edb3c8e3e6c944afe65b2616d46b49305c1420e6967c1fab966ddf8f149502d --cri-socket unix:///run/cri-dockerd.sock
</code></pre><h3 id="验证节点添加结果"><a href="#验证节点添加结果" class="headerlink" title="验证节点添加结果"></a>验证节点添加结果</h3><p>在每个节点添加完成后，即可通过kubectl验证添加结果。下面的命令及其输出是在所有的三个节点均添加完成后运行的，其输出结果表明三个Worker Node已经准备就绪。</p><p>~# kubectl get nodes</p><pre><code class="sh">root@k8s-master01:~# kubectl get nodes
NAME               STATUS   ROLES           AGE    VERSION
k8s-master01.org   Ready    control-plane   80m    v1.26.3
k8s-node01.org     Ready    &lt;none&gt;          15m    v1.26.3
k8s-node2.org      Ready    &lt;none&gt;          114s   v1.26.3
k8s-node3.org      Ready    &lt;none&gt;          11m    v1.26.3
root@k8s-master01:~# 
</code></pre><h3 id="测试应用编排及服务访问"><a href="#测试应用编排及服务访问" class="headerlink" title="测试应用编排及服务访问"></a>测试应用编排及服务访问</h3><p>到此为止，一个master，并附带有三个worker的kubernetes集群基础设施已经部署完成，用户随后即可测试其核心功能。</p><pre><code class="sh">root@k8s-master01:~# kubectl create deployment test-nginx --image=nginx:latest --replicas=3
deployment.apps/test-nginx created
root@k8s-master01:~# 
root@k8s-master01:~# kubectl create service nodeport test-nginx --tcp=80:80
service/test-nginx created
root@k8s-master01:~# 
</code></pre><p>而后，使用如下命令了解Service对象test-nginx使用的NodePort，以便于在集群外部进行访问：</p><pre><code class="sh">root@k8s-master01:~# kubectl get svc -l app=test-nginx
NAME         TYPE       CLUSTER-IP       EXTERNAL-IP   PORT(S)        AGE
test-nginx   NodePort   10.100.229.239   &lt;none&gt;        80:31888/TCP   50s
root@k8s-master01:~# 
</code></pre><pre><code class="text"> 因此，用户可以于集群外部通过&quot;http://NodeIP:31888&quot;这个URL访问we应用，例如于集群外通过浏览器访问&quot;http://192.168.32.203:31888&quot;  
</code></pre><p><img data-src="/../image.assets/1679388005874.png" alt="1679388005874"></p><h2 id="小结"><a href="#小结" class="headerlink" title="小结"></a>小结</h2><p>本文给出了部署Kubernetes分布式集群的具体步骤，并在最后测试了将应用部署并运行于Kubernetes系统上的结果。在读者朋友们自行测试时，cri-dockerd、docker-ce、flannel、kubeadm、kubectl和kubelet的版本均可能存在版本上的不同，也因此可能会存在一定程度上的配置差异，具体调整方式请大家自行参考相关的文档进行</p><div class="tags"><a href="/tags/Kubernetes/" rel="tag"><i class="ic i-tag"></i> Kubernetes</a></div></div><footer><div class="meta"><span class="item"><span class="icon"><i class="ic i-calendar-check"></i> </span><span class="text">更新于</span> <time title="修改时间：2023-05-11 21:14:58" itemprop="dateModified" datetime="2023-05-11T21:14:58+08:00">2023-05-11</time></span></div><div id="copyright"><ul><li class="author"><strong>本文作者： </strong>yuan kun <i class="ic i-at"><em>@</em></i>Hide your thoughts</li><li class="link"><strong>本文链接：</strong> <a href="http://blog.itshare.work/Kubernetes/%E6%90%AD%E5%BB%BAKubernetes%E9%9B%86%E7%BE%A4/" title="搭建Kubernetes集群">http://blog.itshare.work/Kubernetes/搭建Kubernetes集群/</a></li><li class="license"><strong>版权声明： </strong>本站所有文章除特别声明外，均采用 <span class="exturl" data-url="aHR0cHM6Ly9jcmVhdGl2ZWNvbW1vbnMub3JnL2xpY2Vuc2VzL2J5LW5jLXNhLzQuMC9kZWVkLnpo"><i class="ic i-creative-commons"><em>(CC)</em></i>BY-NC-SA</span> 许可协议。转载请注明出处！</li></ul></div></footer></article></div><div class="post-nav"><div class="item left"><a href="/Docker/Docker%E9%95%9C%E5%83%8F%E5%8A%A0%E9%80%9F/" itemprop="url" rel="prev" data-background-image="http:&#x2F;&#x2F;oss.itshare.work&#x2F;itshare-work-images&#x2F;2.jpg" title="Docker镜像加速"><span class="type">上一篇</span> <span class="category"><i class="ic i-flag"></i> Docker</span><h3>Docker镜像加速</h3></a></div><div class="item right"><a href="/zabbix/zabbix5%E9%83%A8%E7%BD%B2%E5%AE%89%E8%A3%85/" itemprop="url" rel="next" data-background-image="http:&#x2F;&#x2F;oss.itshare.work&#x2F;itshare-work-images&#x2F;19.jpg" title="zabbix5部署安装"><span class="type">下一篇</span> <span class="category"><i class="ic i-flag"></i> zabbix</span><h3>zabbix5部署安装</h3></a></div></div><div class="wrap" id="comments"></div></div><div id="sidebar"><div class="inner"><div class="panels"><div class="inner"><div class="contents panel pjax" data-title="文章目录"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#%E6%90%AD%E5%BB%BAKubernetes%E9%9B%86%E7%BE%A4"><span class="toc-number">1.</span> <span class="toc-text">搭建Kubernetes集群</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%83%A8%E7%BD%B2%E5%89%8D%E6%8F%90"><span class="toc-number">1.1.</span> <span class="toc-text">部署前提</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%83%A8%E7%BD%B2%E7%8E%AF%E5%A2%83"><span class="toc-number">1.2.</span> <span class="toc-text">部署环境</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BF%AE%E6%94%B9%E4%B8%BB%E6%9C%BA%E5%90%8D%E7%A7%B0"><span class="toc-number">1.3.</span> <span class="toc-text">修改主机名称</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%BB%E6%9C%BA%E6%97%B6%E9%97%B4%E5%90%8C%E6%AD%A5"><span class="toc-number">1.4.</span> <span class="toc-text">主机时间同步</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%BB%E6%9C%BA%E5%90%8D%E7%A7%B0%E8%A7%A3%E6%9E%90"><span class="toc-number">1.5.</span> <span class="toc-text">主机名称解析</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%A6%81%E7%94%A8Swap%E8%AE%BE%E5%A4%87"><span class="toc-number">1.6.</span> <span class="toc-text">禁用Swap设备</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%A6%81%E7%94%A8%E9%BB%98%E8%AE%A4%E7%9A%84%E9%98%B2%E7%81%AB%E5%A2%99%E6%9C%8D%E5%8A%A1"><span class="toc-number">1.7.</span> <span class="toc-text">禁用默认的防火墙服务</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%AE%89%E8%A3%85%E7%A8%8B%E5%BA%8F%E5%8C%85"><span class="toc-number">1.8.</span> <span class="toc-text">安装程序包</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AE%89%E8%A3%85%E5%B9%B6%E5%90%AF%E5%8A%A8docker"><span class="toc-number">1.8.1.</span> <span class="toc-text">安装并启动docker</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%AE%89%E8%A3%85cri-dockerd"><span class="toc-number">1.9.</span> <span class="toc-text">安装cri-dockerd</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%AE%89%E8%A3%85kubelet%E3%80%81kubeadm%E5%92%8Ckubectl"><span class="toc-number">1.10.</span> <span class="toc-text">安装kubelet、kubeadm和kubectl</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%95%B4%E5%90%88kubelet%E5%92%8Ccri-dockerd"><span class="toc-number">1.10.1.</span> <span class="toc-text">整合kubelet和cri-dockerd</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%85%8D%E7%BD%AEcri-dockerd"><span class="toc-number">1.10.2.</span> <span class="toc-text">配置cri-dockerd</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%85%8D%E7%BD%AEkubelet"><span class="toc-number">1.11.</span> <span class="toc-text">配置kubelet</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%88%9D%E5%A7%8B%E5%8C%96%E7%AC%AC%E4%B8%80%E4%B8%AA%E4%B8%BB%E8%8A%82%E7%82%B9"><span class="toc-number">1.11.1.</span> <span class="toc-text">初始化第一个主节点</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%88%9D%E5%A7%8B%E5%8C%96master%E8%8A%82%E7%82%B9%EF%BC%88%E5%9C%A8k8s-master01%E4%B8%8A%E5%AE%8C%E6%88%90%E5%A6%82%E4%B8%8B%E6%93%8D%E4%BD%9C%EF%BC%89"><span class="toc-number">1.11.2.</span> <span class="toc-text">初始化master节点（在k8s-master01上完成如下操作）</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%88%9D%E5%A7%8B%E5%8C%96%E5%AE%8C%E6%88%90%E5%90%8E%E7%9A%84%E6%93%8D%E4%BD%9C%E6%AD%A5%E9%AA%A4"><span class="toc-number">1.11.2.1.</span> <span class="toc-text">初始化完成后的操作步骤</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%AE%BE%E5%AE%9Akubectl"><span class="toc-number">1.11.3.</span> <span class="toc-text">设定kubectl</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%83%A8%E7%BD%B2%E7%BD%91%E7%BB%9C%E6%8F%92%E4%BB%B6"><span class="toc-number">1.11.4.</span> <span class="toc-text">部署网络插件</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%AA%8C%E8%AF%81master%E8%8A%82%E7%82%B9%E5%B7%B2%E7%BB%8F%E5%B0%B1%E7%BB%AA"><span class="toc-number">1.11.5.</span> <span class="toc-text">验证master节点已经就绪</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%B7%BB%E5%8A%A0%E8%8A%82%E7%82%B9%E5%88%B0%E9%9B%86%E7%BE%A4%E4%B8%AD"><span class="toc-number">1.11.6.</span> <span class="toc-text">添加节点到集群中</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%AA%8C%E8%AF%81%E8%8A%82%E7%82%B9%E6%B7%BB%E5%8A%A0%E7%BB%93%E6%9E%9C"><span class="toc-number">1.11.7.</span> <span class="toc-text">验证节点添加结果</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%B5%8B%E8%AF%95%E5%BA%94%E7%94%A8%E7%BC%96%E6%8E%92%E5%8F%8A%E6%9C%8D%E5%8A%A1%E8%AE%BF%E9%97%AE"><span class="toc-number">1.11.8.</span> <span class="toc-text">测试应用编排及服务访问</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%B0%8F%E7%BB%93"><span class="toc-number">1.12.</span> <span class="toc-text">小结</span></a></li></ol></li></ol></div><div class="related panel pjax" data-title="系列文章"><ul><li class="active"><a href="/Kubernetes/%E6%90%AD%E5%BB%BAKubernetes%E9%9B%86%E7%BE%A4/" rel="bookmark" title="搭建Kubernetes集群">搭建Kubernetes集群</a></li><li><a href="/Kubernetes/Kubernetes%E8%AF%BB%E4%B9%A6%E7%AC%94%E8%AE%B0/" rel="bookmark" title="Kubernetes读书笔记">Kubernetes读书笔记</a></li><li><a href="/Kubernetes/k8s%E8%AF%A6%E7%BB%86%E6%95%99%E7%A8%8B/" rel="bookmark" title="Kubernetes详细教程">Kubernetes详细教程</a></li><li><a href="/Kubernetes/Kubernetes%E5%B8%B8%E7%94%A8%E5%91%BD%E4%BB%A4/" rel="bookmark" title="Kubernetes常用命令">Kubernetes常用命令</a></li></ul></div><div class="overview panel" data-title="站点概览"><div class="author" itemprop="author" itemscope itemtype="http://schema.org/Person"><img class="image" itemprop="image" alt="yuan kun" data-src="/images/avatar.jpg"><p class="name" itemprop="name">yuan kun</p><div class="description" itemprop="description">解决各种服务器、网络、应用等技术问题，致力于保障系统稳定、高效运行</div></div><nav class="state"><div class="item posts"><a href="/archives/"><span class="count">16</span> <span class="name">文章</span></a></div><div class="item categories"><a href="/categories/"><span class="count">7</span> <span class="name">分类</span></a></div><div class="item tags"><a href="/tags/"><span class="count">3</span> <span class="name">标签</span></a></div></nav><div class="social"><span class="exturl item github" data-url="aHR0cHM6Ly9naXRodWIuY29tL2FtZWhpbWUvaGV4by10aGVtZS1zaG9rYQ==" title="https:&#x2F;&#x2F;github.com&#x2F;amehime&#x2F;hexo-theme-shoka"><i class="ic i-github"></i></span></div><ul class="menu"><li class="item"><a href="/" rel="section"><i class="ic i-home"></i>首页</a></li><li class="item"><a href="/about/" rel="section"><i class="ic i-user"></i>关于</a></li><li class="item"><a href="/archives/" rel="section"><i class="ic i-list-alt"></i>归档</a></li><li class="item"><a href="/categories/" rel="section"><i class="ic i-th"></i>分类</a></li><li class="item"><a href="/tags/" rel="section"><i class="ic i-tags"></i>标签</a></li></ul></div></div></div><ul id="quick"><li class="prev pjax"><a href="/Docker/Docker%E9%95%9C%E5%83%8F%E5%8A%A0%E9%80%9F/" rel="prev" title="上一篇"><i class="ic i-chevron-left"></i></a></li><li class="up"><i class="ic i-arrow-up"></i></li><li class="down"><i class="ic i-arrow-down"></i></li><li class="next pjax"><a href="/zabbix/zabbix5%E9%83%A8%E7%BD%B2%E5%AE%89%E8%A3%85/" rel="next" title="下一篇"><i class="ic i-chevron-right"></i></a></li><li class="percent"></li></ul></div></div><div class="dimmer"></div></div></main><footer id="footer"><div class="inner"><div class="widgets"><div class="rpost pjax"><h2>随机文章</h2><ul><li class="item"><div class="breadcrumb"><a href="/categories/zabbix/" title="分类于 zabbix">zabbix</a></div><span><a href="/zabbix/zabbix5%E9%83%A8%E7%BD%B2%E5%AE%89%E8%A3%85/" title="zabbix5部署安装">zabbix5部署安装</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/MySQL/" title="分类于 MySQL">MySQL</a></div><span><a href="/MySQL/MySQL/" title="MySQL数据库基础和安装使用">MySQL数据库基础和安装使用</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/Ansible/" title="分类于 Ansible">Ansible</a></div><span><a href="/Ansible/Ansible/" title="运维自动化工具Ansible(一)">运维自动化工具Ansible(一)</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/Kubernetes/" title="分类于 Kubernetes">Kubernetes</a></div><span><a href="/Kubernetes/%E6%90%AD%E5%BB%BAKubernetes%E9%9B%86%E7%BE%A4/" title="搭建Kubernetes集群">搭建Kubernetes集群</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/Kubernetes/" title="分类于 Kubernetes">Kubernetes</a></div><span><a href="/Kubernetes/k8s%E8%AF%A6%E7%BB%86%E6%95%99%E7%A8%8B/" title="Kubernetes详细教程">Kubernetes详细教程</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/Linux/" title="分类于 Linux">Linux</a> <i class="ic i-angle-right"></i> <a href="/categories/Linux/tomcat/" title="分类于 tomcat">tomcat</a></div><span><a href="/Linux/tomcat/tomcat/" title="tomcat">tomcat</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/Linux/" title="分类于 Linux">Linux</a></div><span><a href="/Linux/DNS/" title="DNS服务">DNS服务</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/Kubernetes/" title="分类于 Kubernetes">Kubernetes</a></div><span><a href="/Kubernetes/Kubernetes%E5%B8%B8%E7%94%A8%E5%91%BD%E4%BB%A4/" title="Kubernetes常用命令">Kubernetes常用命令</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/MySQL/" title="分类于 MySQL">MySQL</a></div><span><a href="/MySQL/MySQL%E9%9B%86%E7%BE%A4/" title="MySQL集群">MySQL集群</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/Ansible/" title="分类于 Ansible">Ansible</a></div><span><a href="/Ansible/Ansible2/" title="运维自动化工具Ansible(二)">运维自动化工具Ansible(二)</a></span></li></ul></div></div><div class="status"><div class="copyright">&copy; 2022 – <span itemprop="copyrightYear">2023</span> <span class="with-love"><i class="ic i-sakura rotate"></i> </span><span class="author" itemprop="copyrightHolder">yuan kun @ Cookie</span></div><div class="count"><span class="post-meta-item-icon"><i class="ic i-chart-area"></i> </span><span title="站点总字数">287k 字</span> <span class="post-meta-divider">|</span> <span class="post-meta-item-icon"><i class="ic i-coffee"></i> </span><span title="站点阅读时长">4:21</span></div><div class="powered-by">基于 <span class="exturl" data-url="aHR0cHM6Ly9oZXhvLmlv">Hexo</span> & Theme.<span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL2FtZWhpbWUvaGV4by10aGVtZS1zaG9rYQ==">Shoka</span></div></div></div></footer></div><script data-config type="text/javascript">var LOCAL={path:"Kubernetes/搭建Kubernetes集群/",favicon:{show:"（●´3｀●）やれやれだぜ",hide:"(´Д｀)大変だ！"},search:{placeholder:"文章搜索",empty:"关于 「 ${query} 」，什么也没搜到",stats:"${time} ms 内找到 ${hits} 条结果"},valine:!0,fancybox:!0,copyright:'复制成功，转载请遵守 <i class="ic i-creative-commons"></i>BY-NC-SA 协议。',ignores:[function(e){return e.includes("#")},function(e){return new RegExp(LOCAL.path+"$").test(e)}]}</script><script src="https://cdn.polyfill.io/v2/polyfill.js"></script><script src="//cdn.jsdelivr.net/combine/npm/pace-js@1.0.2/pace.min.js,npm/pjax@0.2.8/pjax.min.js,npm/whatwg-fetch@3.4.0/dist/fetch.umd.min.js,npm/animejs@3.2.0/lib/anime.min.js,npm/algoliasearch@4/dist/algoliasearch-lite.umd.js,npm/instantsearch.js@4/dist/instantsearch.production.min.js,npm/lozad@1/dist/lozad.min.js,npm/quicklink@2/dist/quicklink.umd.js"></script><script src="/js/app.js?v=0.2.5"></script></body></html><!-- rebuild by hrmmi -->